<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <data>

    <!-- 1) Acción que aparece en Inventario → Productos → Imprimir -->
    <record id="action_report_product_label_4x12" model="ir.actions.report">
      <field name="name">Etiqueta de producto 4×12 cm (Sin precio)</field>
      <field name="model">product.product</field>
      <field name="report_type">qweb-pdf</field>
      <field name="report_name">barcodes.report_product_label_4x12</field>
      <field name="report_file">barcodes.report_product_label_4x12</field>
      <field name="binding_model_id" ref="product.model_product_product"/>
      <field name="binding_type">report"/>
    </record>

    <!-- 2) Heredamos la plantilla original y forzamos Code128 -->
    <template id="report_product_label_4x12"
              inherit_id="barcodes.report_product_label_4x12">
      <!-- A) Ajuste de tamaño: 4 × 12 cm -->
      <xpath expr="//div[contains(@class,'label')]" position="attributes">
        <attribute name="style">
          width:4cm; height:12cm; display:inline-block;
          margin:1mm; border:1px solid #000;
          text-align:center; padding:2px;
          page-break-inside:avoid;
        </attribute>
      </xpath>
      <!-- B) Forzamos Code128 para la imagen de barras -->
      <xpath expr="//span[@t-field='product.barcode']" position="attributes">
        <attribute name="t-field-options">
          {'widget':'barcode',
           'barcode_type':'Code128',
           'width': 400,
           'height': 120}
        </attribute>
      </xpath>
      <!-- C) (Opcional) El número var.default_code o var.barcode bajo la barra -->
      <xpath expr="//div[contains(@class,'label_name')]" position="replace">
        <div class="label_name" style="font-size:8px; margin-top:4px;">
          <t t-esc="product.barcode or product.default_code"/>
        </div>
      </xpath>
    </template>

  </data>
</odoo>
