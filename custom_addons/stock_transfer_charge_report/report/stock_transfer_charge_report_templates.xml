<template id="stock_transfer_charge_report_template">
  <t t-call="web.html_container">
    <!-- Fallback: si no viene la variable, la convertimos en {} -->
    <t t-set="precios_interno" t-value="precios_interno or {}"/>
    <t t-foreach="docs" t-as="o">
      <t t-call="web.external_layout">
        <div class="page">
          ...
          <table class="table table-sm" t-if="o.move_line_ids_without_package">
            <thead> â€¦ </thead>
            <tbody>
              <tr t-foreach="o.move_line_ids_without_package" t-as="ml">
                <td><t t-esc="ml.product_id.display_name"/></td>
                <td><t t-esc="ml.quantity"/></td>
                <td><t t-esc="ml.product_uom_id.name"/></td>
                <!-- precio interno desde la pricelist -->
                <td>
                  <t t-esc="precios_interno.get(ml.id, 0.0)"/>
                </td>
                <!-- subtotal interno -->
                <td>
                  <t t-esc="ml.quantity * precios_interno.get(ml.id, 0.0)"/>
                </td>
              </tr>
            </tbody>
          </table>
          <!-- total general -->
          <p style="text-align:right; margin-top:1em;">
            <strong>Total Interno (CLP):</strong>
            <t t-esc="total_interno or 0.0"/>
          </p>
          ...
        </div>
      </t>
    </t>
  </t>
</template>
